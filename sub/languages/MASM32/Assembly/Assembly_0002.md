[Top](../../../../index.md)\>
[プログラミング言語](../../../pgl.md)\>
[アセンブリ（MASM32）](../../language_0001.md)\>
[アセンブリ言語の実践的活用](../MASM32_0014.md)

# アセンブリ言語モジュールとC\+\+プログラムのリンク

C\+\+プログラム（アセンブリ言語で記述された関数を呼び出す）と  
アセンブリ言語で記述されたモジュール（関数の定義）をまとめてビルドすることで、  
アセンブリ言語モジュールとC\+\+プログラムのリンクが実現できる

## 書式（C\+\+）

    extern "C" int __stdcall 関数名(引数のデータ型1 引数1,引数のデータ型2 引数2,引数のデータ型3 引数3,・・・);

上記コードをmain関数の前に記述  
「extern "C"」は、呼び出す関数がC言語スタイルの関数であることを示す  
C\+\+プログラムでは、同じ名前で異なる引数の関数を作成可能であるため、  
コンパイル時に関数名が変更される  
C言語の関数として呼び出すことで、関数名の変更を防ぐことができる  
「__stdcall」は、アセンブリ言語プログラムで宣言する呼び出し規約「stdcall」に対応している

## 書式（アセンブリ）

    .486
    .model flat,stdcall
    option casemap :none

    .code

    関数名 proc パラメータサイズ1:パラメータ1,パラメータサイズ2:パラメータ2,パラメータサイズ3:パラメータ3,・・・
        処理
        ret
    関数名 endp

    end

アセンブリ言語のプロシージャの戻り値はeaxレジスタに保存されて呼び出し側に返されるため、演算結果はeaxレジスタに保存する（dllを作成する場合も同様）